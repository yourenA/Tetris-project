"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),Block=function(){function e(t){_classCallCheck(this,e),this.siteSize=t.siteSize,this.arr=t.arr,this.BLOCK_SIZE=t.BLOCK_SIZE,this.curLeft=t.curLeft,this.curTop=t.curTop}return _createClass(e,[{key:"clockwise",value:function(e){for(var t=[],o=0;o<=e.length-1;o++){for(var r=[],a=e.length-1;a>=0;a--)r.push(e[a][o]);t.push(r)}console.log(t);var n=[],i=[];return this.checkArrWith1(t,function(e,t){n.push(t*this.BLOCK_SIZE),i.push(e*this.BLOCK_SIZE)}),{newArr:t,lefts:n,tops:i}}},{key:"checkArrWith1",value:function(e,t){for(var o=0;o<=e.length-1;o++){console.log(e[o]);for(var r=0;r<=e.length-1;r++)1==e[o][r]&&(console.log("i:",o," j:",r),t.call(this,o+this.curTop,r+this.curLeft))}}},{key:"draw",value:function(e,t){var o=document.createElement("div");o.className="activityModel",o.style.top=e*this.BLOCK_SIZE+"px",o.style.left=t*this.BLOCK_SIZE+"px",document.body.appendChild(o)}},{key:"canMove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(document.querySelectorAll(".activityModel"),[]),r=[],a=!0,n=!0,i=!0,l=!0;this.checkArrWith1(e,function(e,t){o.push(parseInt(e*this.BLOCK_SIZE)),r.push(parseInt(t*this.BLOCK_SIZE))});var c=Math.min.apply(Math,o),s=Math.min.apply(Math,r),h=Math.max.apply(Math,r),u=Math.max.apply(Math,o);return t?h+20>=this.siteSize.left+this.siteSize.width&&(a=!1):h+20>=this.siteSize.left+this.siteSize.width&&(a=!1),s-20<this.siteSize.left&&(l=!1),u+20>=this.siteSize.top+this.siteSize.height&&(i=!1),c-20<this.siteSize.top&&(n=!1),{canMoveRight:a,canMoveLeft:l,canMoveTop:n,canMoveDown:i}}},{key:"move",value:function(){var e=this;document.onkeydown=function(t){var o=document.querySelectorAll(".activityModel"),r=void 0,a=void 0,n=void 0,i=void 0,l=t.keyCode;switch(console.log("key",l),l){case 37:if(n=e.canMove(e.arr).canMoveLeft){var c=!0,s=!1,h=void 0;try{for(var u,f=o[Symbol.iterator]();!(c=(u=f.next()).done);c=!0){var v=u.value;v.style.left=parseInt(v.style.left)-20+"px"}}catch(e){s=!0,h=e}finally{try{!c&&f.return&&f.return()}finally{if(s)throw h}}e.curLeft--}else console.log("can`t move left");break;case 38:var p=e.clockwise(e.arr),y=p.newArr,d=p.lefts,w=p.tops;if(r=e.canMove(y,!0),i=r.canMoveDown,a=r.canMoveRight,a&&a){e.arr=y;for(var S in d)o[S].style.left=d[S]+"px",o[S].style.top=w[S]+"px"}break;case 39:if(a=e.canMove(e.arr).canMoveRight){var g=!0,M=!1,k=void 0;try{for(var m,I=o[Symbol.iterator]();!(g=(m=I.next()).done);g=!0){var C=m.value;C.style.left=parseInt(C.style.left)+20+"px"}}catch(e){M=!0,k=e}finally{try{!g&&I.return&&I.return()}finally{if(M)throw k}}e.curLeft++}else console.log("can`t move right");break;case 40:if(i=e.canMove(e.arr).canMoveDown){var L=!0,b=!1,_=void 0;try{for(var x,z=o[Symbol.iterator]();!(L=(x=z.next()).done);L=!0){var B=x.value;B.style.top=parseInt(B.style.top)+20+"px"}}catch(e){b=!0,_=e}finally{try{!L&&z.return&&z.return()}finally{if(b)throw _}}e.curTop++}else console.log("can`t move down");break;default:console.log("请选择上下左右按键")}}}},{key:"init",value:function(){this.checkArrWith1(this.arr,this.draw)}}]),e}();window.onload=function(){console.log("window onload");var e=document.querySelector(".site"),t=window.getComputedStyle(e),o=t.width,r=t.height,a=t.left,n=t.top,i={width:parseInt(o),height:parseInt(r),left:parseInt(a),top:parseInt(n)},l=[[1,0],[1,0],[1,1]],c=20,s=parseInt((i.left+i.width/2)/c),h=parseInt(i.top/c);console.log("curLeft",s),console.log("curTop",h);var u={arr:l,siteSize:i,BLOCK_SIZE:c,curLeft:s,curTop:h},f=new Block(u);f.init(),f.move()};